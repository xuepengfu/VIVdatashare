kb=[em/l*area            0              0          0              0               0      -em*area/l              0              0          0              0            0; 
           0   em*12*I/l^3              0          0              0      6*em*I/l^2               0   -12*em*I/l^3              0          0              0   6*em*I/l^2;
           0             0    em*12*I/l^3          0    -6*em*I/l^2               0               0              0   -12*em*I/l^3          0    -6*em*I/l^2            0;
           0             0              0      G*J/l              0               0               0              0              0     -G*J/l              0            0;
           0             0    -6*em*I/l^2          0       4*em*I/l               0               0              0     6*em*I/l^2          0       2*em*I/l            0;
           0    6*em*I/l^2              0          0              0        4*em*I/l               0    -6*em*I/l^2              0          0              0     2*em*I/l;
  -em*area/l             0              0          0              0               0       em*area/l              0              0          0              0            0;
           0  -12*em*I/l^3              0          0              0     -6*em*I/l^2               0    em*12*I/l^3              0          0              0  -6*em*I/l^2;
           0             0   -12*em*I/l^3          0     6*em*I/l^2               0               0              0    em*12*I/l^3          0     6*em*I/l^2            0;
           0             0              0     -G*J/l              0               0               0              0              0      G*J/l              0            0;
           0             0    -6*em*I/l^2          0       2*em*I/l               0               0              0     6*em*I/l^2          0       4*em*I/l            0;
           0    6*em*I/l^2              0          0              0        2*em*I/l               0    -6*em*I/l^2              0          0              0     4*em*I/l;];
          
kt = Tension*[     0         0          0          0              0               0               0              0              0          0              0            0
                   0     6/5/l          0          0              0            1/10               0         -6/5/l              0          0              0         1/10
                   0         0      6/5/l          0          -1/10               0               0              0         -6/5/l          0          -1/10            0
                   0         0          0          0              0               0               0              0              0          0              0            0  
                   0         0      -1/10          0         2*l/15               0               0              0           1/10          0        -1*l/30            0
                   0      1/10          0          0              0          2*l/15               0           -1/10             0          0              0      -1*l/30
                   0         0          0          0              0               0               0              0              0          0              0            0
                   0    -6/5/l          0          0              0           -1/10               0          6/5/l              0          0              0        -1/10
                   0         0     -6/5/l          0           1/10               0               0              0          6/5/l          0           1/10            0
                   0         0          0          0              0               0               0              0              0          0              0            0  
                   0         0      -1/10          0        -1*l/30               0               0              0           1/10          0         2*l/15            0
                   0      1/10          0          0              0         -1*l/30               0          -1/10              0          0              0       2*l/15];
                   
k=kb+kt;

k=t'*k*t;
kb=t'*kb*t;

K=zeros(nnode*ndof);
Kb=zeros(nnode*ndof);
for i=1:nel   
    K(6*i-5:6*i+6,6*i-5:6*i+6)=K(6*i-5:6*i+6,6*i-5:6*i+6)+k(1:12,1:12);
end
for i=1:nel   
    Kb(6*i-5:6*i+6,6*i-5:6*i+6)=Kb(6*i-5:6*i+6,6*i-5:6*i+6)+kb(1:12,1:12);
end
